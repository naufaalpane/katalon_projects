@using System;
@using Toyota.Common.Web.Platform;

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section HeadScript{
}
@Html.Partial("_SearchCriteria")

@section BodyScript{


    <script type="text/javascript" src="@Url.Content("~/Content/Bootstrap/js/date-time/bootstrap-datepicker.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/js/common.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/tdk/jquery.bootstrap-growl.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/js/jquery.blockUI.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/js/jquery-msgbox/jquery.msgBox.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/tdk/jquery.filedownload.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/tdk/jquery.bootstrap-growl.min.js")"></script>

    <script type="text/javascript" src="@Url.Content("~/Content/Bootstrap/js/date-time/bootstrap-datepicker.js")"></script>

    <script type="text/javascript">



        $(document).ready(function () {

            $("#txtDate").datepicker({
                format: 'ddmmyyyy',
                container: '#MonthDatePicker',
                orientation: 'top',
                autoclose : true
            });



        })
        function changeProcessCd() {

                $.ajax({
                    type: "POST",
                    url: "@Html.Toyota().Page.GetActionUrl("Search")",
                    async: false,
                    data: {
                        PROCESS_CD: $("#proccd").val()

                    },
                    success: function (data) {
                        $("#gridTableCourse").html(data);
                        popUpProgressHide();
                    },
                    error: function (data) {
                        popUpProgressHide();
                    }
                });
            }

        function doExecute() {
            var data = new Object();
            data.listData = [];

            $(".grid-checkbox-body:checked").each(function () {

                data.listData.push($(this).attr('data-lineCD'));
                console.log(data);
            });

            var LINE_CD = data.listData.join(',');

            var isHaveChecked = false;
            $("input[name='chkRow']").each(function () {
                if ($(this).prop('checked')) {
                    isHaveChecked = true;
                }
            });

            if (!isHaveChecked) {
                showErrorMesgGrowl("ERROR: A single record must be selected to be EXECUTE");

            }
            else {
                 $.ajax({
                    type: "POST",
                    url: "@Html.Toyota().Page.GetActionUrl("Execute")",
                    async: false,
                    data: {
                        PROCESS_CD: $("#proccd").val(),
                        LINE_CD: LINE_CD,
                        DDMMYYYY: $("#txtDate").val(),
                        COMPANY_CD: $("#comcd").text()

                    },
                    success: function (data) {
                        $("#gridTableCourse").html();
                        $("#txtDate").val('');
                        $("input[type=checkbox]").prop("checked", false);
                        popUpProgressHide();
                    },
                    error: function (data) {
                        popUpProgressHide();
                        $("#txtDate").val('');
                        $("input[type=checkbox]").prop("checked", false);
                        $("#gridTableCourse").html();
                    }
                });

            }

        }

    </script>
}