@using System;
@using Toyota.Common.Web.Platform;

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@Html.Partial("_SearchCriteria")


@section HeadScript{

}

@section BodyScript{

    <script type="text/javascript" src="@Url.Content("~/Content/js/jquery.blockUI.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/js/common.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/js/jquery-msgbox/jquery.msgBox.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/tdk/jquery.filedownload.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Content/tdk/jquery.bootstrap-growl.min.js")"></script>



    <script type="text/javascript">

        $(document).ready(function () {
            $("._datepicker").datepicker({
                format: 'yyyymm',
                autoclose: true,
                minViewMode: 'months',
                container: '#MonthDatePicker',
                orientation: 'top'
            });

            $('#txtYear').prop("disabled", true);
        })

        function changeProcessCd() {

                $.ajax({
                    type: "POST",
                    url: "@Html.Toyota().Page.GetActionUrl("Search")",
                    async: false,
                    data: {
                        PROCESS_CD: $("#proccd").val(),
                        COMPANY_CD: $("#comcd").text()
                    },
                    success: function (data) {
                        $("#gridTableCourse").html(data);
                        popUpProgressHide();
                        $('#txtYear').prop("disabled", false);
                    },
                    error: function (data) {
                        popUpProgressHide();
                    }
                });
        }

        function onPrint() {
            var data = new Object();
            data.listData = [];

            $(".grid-checkbox-body:checked").each(function () {

                data.listData.push($(this).attr('data-lineCD'));
                console.log(data);
            });

            var LINE_CD = data.listData.join(',');

            var isHaveChecked = false;
            $("input[name='chkRow']").each(function () {
                if ($(this).prop('checked')) {
                    isHaveChecked = true;
                }
            });

            if (!isHaveChecked) {
                showErrorMesgGrowl("ERROR: A single record must be selected to be Print");

            }
            else if ($("#txtYearStart").val() == '' || $("#txtYearStart").val() == 0) {
                showErrorMesgGrowl("ERROR: Year Month Start should no be empty");
            }
            else if ($("#txtYearEnd").val() == '' || $("#txtYearEnd").val() == 0) {
                showErrorMesgGrowl("ERROR: Year Month End should no be empty");
            }
            else {
                 $.ajax({
                    type: "POST",
                    url: "@Html.Toyota().Page.GetActionUrl("Print")",
                    async: false,
                     data: {
                        COMPANY_CD: $("#comcd").text(),
                        PROCESS_CD: $("#proccd").val(),
                        LINE_CD: LINE_CD,
                        YYYYMM: $("#txtYear").val()
                    },
                    success: function (data) {
                        $("#gridTableCourse").html();
                        $("#txtDate").val('');
                        $("input[type=checkbox]").prop("checked", false);
                        popUpProgressHide();
                    },
                    error: function (data) {
                        popUpProgressHide();
                        $("#txtDate").val('');
                        $("input[type=checkbox]").prop("checked", false);
                        $("#gridTableCourse").html();
                    }
                });

            }

        }

    </script>


}

